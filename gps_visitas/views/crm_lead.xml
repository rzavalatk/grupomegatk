<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="custom_crm_lead" model="ir.ui.view">
            <field name="name">crm.lead.custom</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_oppor" />
            <field name="arch" type="xml">
                <xpath expr="//form[@class='o_opportunity_form']" position="inside">
                    <script type="text/javascript" src="/gps_visitas/static/src/js/controller.js"/>
                </xpath>
                <xpath expr="//button[@name='toggle_active']" position="after">
                    <field name="id" invisible="1" />
                    <field name="see_init_visit" invisible="1" />
                    <field name="see_end_visit" invisible="1" />
                    <button string="Iniciar visita" id="init_visit" attrs="{'invisible': ['|',('see_init_visit', '=', False),('see_end_visit', '=', True)]}" class="oe_highlight"/>
                    <button string="Finalizar visita" id="end_visit" attrs="{'invisible': [('see_end_visit', '=', False)]}" class="oe_highlight"/>
                </xpath>
                <xpath expr="//field[@name='active']" position="before">
                    <div id="hidden_box" class="modal fade" data-backdrop="static">
                        <div class="modal-dialog modal-content" style="min-height:150px;max-width:400px;">
                            <div class="modal-body" id="pop_html">
                                <a href="#" class="o_popup_btn_close o_not_editable o_default_snippet_text pull-right" data-dismiss="modal" style="font-size:30px">×</a>
                                <br/>
                                <h2 style="text-align:start; font-size 24px; font-weight:bold" class="o_default_snippet_text">Error:</h2>
                                <p style="font-size 12px; font-weight:bold">No se otorgaron permisos de ubicación</p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" id="buton-close" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                <a id="go" role="button" href="/" class="btn btn-primary">Abrir otro navegador</a>
                            </div>
                        </div>
                    </div>
                </xpath>
                <xpath expr="//div[@name='button_box']/button" position="after">
                    <button class="oe_stat_button" type="object" context="{'partner_id': partner_id}" name="go_to_visits_filter" icon="fa-map">
                        <div class="o_stat_info">
                            <field name="num_visits" class="o_stat_value" readonly="1"/>
                            <span>Visitas</span>
                        </div>
                    </button>
                </xpath>
            </field>
        </record>
    </data>
</odoo>
